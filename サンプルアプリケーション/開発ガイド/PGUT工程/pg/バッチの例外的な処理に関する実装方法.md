# バッチの例外的な処理に関する実装方法

## はじめに
本書では例外的な処理に関する実装方法について記載します。

## 例外のハンドリング
### 全般
#### 更新時の排他制御エラー

##### 排他制御エラーに起きること
DaoContext#updateがjavax.persistence.OptimisticLockExceptionをスローします。

##### ハンドリング内容
そのままスローします。  
 (共通エラー画面への遷移は基盤側で制御します)


#### 1件取得時存在するはずのデータが取得できなかった場合

##### 排他制御エラーに起きること
DaoContextのメソッドがnablarch.common.dao.NoDataExceptionをスローします。

##### ハンドリング内容
そのままスローします。  
 (共通エラー画面への遷移は基盤側で制御します)

### 検索一覧画面
#### 検索結果0件時

##### 検索結果0件時に起きること
検索結果0件の場合、DaoContext#findAllBySqlFile(java.lang.Class<T>, java.lang.String sqlId, java.lang.Object params) が空のリストを返却します。

##### ハンドリング内容
ActionクラスのメソッドでApplicationExceptionを送出します。

````java
throw new ApplicationException(
        MessageUtil.createMessage(MessageLevel.ERROR,
                "errors.search.nothing"));
````

JSPにはn:errorsを記載します。
````java
<n:errors filter="global"/>
````
補足：filter属性にglobalを記載することで、入力項目と紐づかないエラーのみが出力されます。
