# エビデンスの取得方法（ログとDBダンプ）

## エビデンスの取得前の準備

### ログ

ローカルのログファイルを消します。 
後で必要な部分だけを取り出す作業を容易にするためです。

### DBダンプ

#### テーブル定義一覧を更新

単体テスト用データダンプツール(YoyoTool)のテーブル定義一覧を更新します。 
更新は以下の手順で行います。

1. DUMP.xlsmを開きます。
1. MAINシート画面上部の「テーブル定義取得」をクリックします。
1. 表示されたダイアログにedmファイルが存在するディレクトリを指定してください。  
   `<クローンしたディレクトリ>\proman-project\proman-common\src\main\resources\entity` になります。  
   パスの最後の「\」は不要です。
1. 取得するテーブルについてI列を「○」に変更してください。  
   どのテーブルを取得するかは、 `/サンプルプロジェクト/設計書/A1_プロジェクト管理システム/020_方式設計/020_開発標準/020_テスト標準/単体テスト標準.xlsx` の `3.3.2. 取引単体テストのエビデンス` を参照してください。
1. **DUMP.xlsmを保存してください。**

#### テスト実行前のデータダンプを取得

1. DUMP.xlsmのMAINシート画面上部の「起動」をクリックします。
1. ダンプツールのウインドウが表示される。表示されたウインドウの「シートクリア」をクリックします。
1. 「DBダンプ取得」をクリックします。
1. DUMPエクスポートをクリックし、ダンプを保存するディレクトリを指定します。
1. ダンプツールを右上の「×」をクリックしてウインドウを閉じります。


## エビデンスの取得方法

### ログ

テスト対象を実行します。  
テスト対象実行後、ログファイルを確認し、テストケースとの紐づけが分かりにく場合は、ログファイルを分割するなど対応します。

### DBダンプ

#### テスト実行後のデータダンプを取得

取得方法は「[テスト実行前のデータダンプを取得](#テスト実行前のデータダンプを取得)」と同じです。  
テスト前テスト後のダンプを確認し、想定通りのレコード及びカラムが更新されていることを確認します。  
確認したら、更新された箇所のカラムの背景色を黄色に変更して保存します。


## エビデンスの取得後

`/サンプルプロジェクト/設計書/A1_プロジェクト管理システム/020_方式設計/020_開発標準/020_テスト標準/単体テスト標準.xlsx` の `3.3.4. エビデンスの格納方法` に従って保存します。
